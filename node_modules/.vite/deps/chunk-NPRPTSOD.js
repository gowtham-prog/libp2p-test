import {
  Uint8ArrayList
} from "./chunk-ADNOUI46.js";

// ../../node_modules/it-reader/dist/src/index.js
function reader(source) {
  const reader2 = async function* () {
    let bytes = yield;
    let bl = new Uint8ArrayList();
    for await (const chunk of source) {
      if (bytes == null) {
        bl.append(chunk);
        bytes = yield bl;
        bl = new Uint8ArrayList();
        continue;
      }
      bl.append(chunk);
      while (bl.length >= bytes) {
        const data = bl.sublist(0, bytes);
        bl.consume(bytes);
        bytes = yield data;
        if (bytes == null) {
          if (bl.length > 0) {
            bytes = yield bl;
            bl = new Uint8ArrayList();
          }
          break;
        }
      }
    }
    if (bytes != null) {
      throw Object.assign(new Error(`stream ended before ${bytes} bytes became available`), { code: "ERR_UNDER_READ", buffer: bl });
    }
  }();
  void reader2.next();
  return reader2;
}

export {
  reader
};
//# sourceMappingURL=chunk-NPRPTSOD.js.map
